# coding:utf-8from flask import Flask, request, render_template, redirect, url_for, sessionfrom db import *import timeimport tracebackapp = Flask(__name__)app.secret_key = "1q2w34"@app.route('/', methods=("GET", "POST"))def user_login():	error = None	result = None	# field = ['name', 'password']	if request.method == "GET":		return render_template('login.html')	if request.method == 'POST':		data = dict((k, v[0]) for k, v in dict(request.form).items())		print data		if not data['name'] or not data['password']:			error = 'username or password could not be null!!!!'			# return render_template('login.html', error=error)		print user_list('name')		# if data['name'] not in data['name']:		# 	error = 'user is not exist'		# 	return render_template('login.html', error=error)		# try:		# 	sql_user = "select 1 from users where name = '%s'" % (data['name'][0])		# 	cur.execute(sql_user)		# 	user_stored = cur.fetchone()		# 	if not user_stored:		# 		error = 'username is incorrect'		# 		return render_template('login.html', error=error)		# 	else:		# 		if data['name'][0] == 'admin':		# 			sql_password = "select %s from users where name ='%s' " % (field[1], data['name'][0])		# 			cur.execute(sql_password)		# 			password_stored = cur.fetchone()[0]		# 			if data[field[1]][0] == password_stored:		# 				message = 'welcome admin'		# 				# return render_template('login.html', message=message)		# 				return redirect('/userlist')		# 			else:		# 				error = 'password incorrect !!'		# 				return render_template('login.html', error=error)		# 		else:		# 			sql_password = "select %s from users where name ='%s' " % (field[1], data['name'][0])		# 			cur.execute(sql_password)		# 			password_stored = cur.fetchone()[0]		# 			# conn.close()		# 			# cur.close()		# 			if data[field[1]][0] == password_stored:		# 				message = 'welcome %s to login system' % data['name'][0]		# 				# return render_template('login.html', message=message)		# 				return redirect(url_for('user', name=data['name'][0]))		# 			else:		# # 				error = 'password incorrect !!'		# 				return render_template('login.html', error=error)		# except(mysql.MySQLError, Exception):		# 	error = 'db error'		# 	return render_template('login.html', error=error)	return render_template('login.html', error=error)if __name__ == "__main__":	app.run(host="0.0.0.0", port=8080, debug=True)